<script>
  const form = document.getElementById('gohanForm');
  const resultBox = document.getElementById('result');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    resultBox.textContent = '提案を生成中...';

    const mood = document.getElementById('mood').value;
    const range = document.getElementById('range').value;
    const budget = document.getElementById('budget').value;
    const ingredients = document.getElementById('ingredients').value;
    const genre = document.getElementById('genre').value;

    const body = {
      mood,
      range,
      budget,
      ingredients,
      genre
    };

    try {
      const response = await fetch('/api/gpt', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json'
        },
        body: JSON.stringify(body)
      });

      const data = await response.json();

      if (data.error) {
        resultBox.textContent = 'エラー: ' + data.error.message;
      } else {
        resultBox.textContent = data.result;
      }
    } catch (error) {
      resultBox.textContent = 'エラーが発生しました：' + error.message;
    }
  });
</script>
